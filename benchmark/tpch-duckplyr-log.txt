> library(commandArgs(TRUE)[1], character.only=T)
> 
> test_dplyr_q <- list()
> 
> tables <- c("lineitem", "partsupp", "part", "supplier", "nation", "orders", "customer", "region")
> env <- environment()
> lapply(tables, function(t) {
+   assign(t, readRDS(paste0(t, ".rds")), env=env)
+   NULL
+ })
[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL

[[5]]
NULL

[[6]]
NULL

[[7]]
NULL

[[8]]
NULL

> 
> 
> test_dplyr_q[[1]] <- function() {
+   lineitem |>
+     select(l_shipdate, l_returnflag, l_linestatus, l_quantity, 
+         l_extendedprice, l_discount, l_tax) |>
+     filter(l_shipdate <= "1998-09-02") |>
+     select(l_returnflag, l_linestatus, l_quantity, l_extendedprice, l_discount, l_tax) |>
+     group_by(l_returnflag, l_linestatus) |>
+     summarise(
+       sum_qty = sum(l_quantity),
+       sum_base_price = sum(l_extendedprice),
+       sum_disc_price = sum(l_extendedprice * (1 - l_discount)),
+       sum_charge = sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)),
+       avg_qty = mean(l_quantity),
+       avg_price = mean(l_extendedprice),
+       avg_disc = mean(l_discount),
+       count_order = n()
+     ) |>
+     arrange(l_returnflag, l_linestatus)
+ }
> 
> test_dplyr_q[[2]] <- function() {
+   ps <- partsupp |> select(ps_partkey, ps_suppkey, ps_supplycost)
+ 
+   p <- part |>
+     select(p_partkey, p_type, p_size, p_mfgr) |>
+     filter(p_size == 15, grepl(".*BRASS$", p_type)) |>
+     select(p_partkey, p_mfgr)
+ 
+   psp <- inner_join(ps, p, by = c("ps_partkey" = "p_partkey"))
+ 
+   sp <- supplier |>
+     select(s_suppkey, s_nationkey, s_acctbal, s_name, 
+         s_address, s_phone, s_comment)
+ 
+   psps <- inner_join(psp, sp,
+     by = c("ps_suppkey" = "s_suppkey")) |> 
+     select(ps_partkey, ps_supplycost, p_mfgr, s_nationkey, 
+         s_acctbal, s_name, s_address, s_phone, s_comment)
+ 
+   nr <- inner_join(nation,
+     region |> filter(r_name == "EUROPE"), 
+     by = c("n_regionkey" = "r_regionkey")) |> 
+     select(n_nationkey, n_name)
+   
+   pspsnr <- inner_join(psps, nr, 
+     by = c("s_nationkey" = "n_nationkey")) |> 
+   select(ps_partkey, ps_supplycost, p_mfgr, n_name, s_acctbal, 
+     s_name, s_address, s_phone, s_comment)
+ 
+   aggr <- pspsnr |>
+     group_by(ps_partkey) |>
+     summarise(min_ps_supplycost = min(ps_supplycost))
+ 
+   sj <- inner_join(pspsnr, aggr, 
+     by=c("ps_partkey" = "ps_partkey", "ps_supplycost" = "min_ps_supplycost"))
+ 
+ 
+   res <- sj |>
+     select(s_acctbal, s_name, n_name, ps_partkey, p_mfgr, 
+         s_address, s_phone, s_comment) |>
+         # TODO
+     #arrange(desc(s_acctbal), n_name, s_name, ps_partkey) |>
+       arrange(s_acctbal, n_name, s_name, ps_partkey) |>
+ 
+     head(100)
+ 
+   res
+ }
> 
> test_dplyr_q[[3]] <- function() {
+   oc <- inner_join(
+     orders |>
+       select(o_orderkey, o_custkey, o_orderdate, o_shippriority) |>
+       filter(o_orderdate < "1995-03-15"),
+     customer |>
+       select(c_custkey, c_mktsegment) |>
+       filter(c_mktsegment == "BUILDING"),
+     by = c("o_custkey" = "c_custkey")
+   ) |>
+     select(o_orderkey, o_orderdate, o_shippriority)
+ 
+   loc <- inner_join(
+     lineitem |>
+       select(l_orderkey, l_shipdate, l_extendedprice, l_discount) |>
+       filter(l_shipdate > "1995-03-15") |>
+       select(l_orderkey, l_extendedprice, l_discount),
+     oc, by = c("l_orderkey" = "o_orderkey")
+   )
+ 
+   aggr <- loc |> mutate(volume=l_extendedprice * (1 - l_discount)) |>
+     group_by(l_orderkey, o_orderdate, o_shippriority) |>
+     summarise(revenue = sum(volume)) |>
+     select(l_orderkey, revenue, o_orderdate, o_shippriority) |>
+         #arrange(desc(revenue), o_orderdate) |>
+     arrange(revenue, o_orderdate) |>
+     head(10)
+   aggr
+ }
> 
> test_dplyr_q[[4]] <- function() {
+   l <- lineitem |>
+     select(l_orderkey, l_commitdate, l_receiptdate) |>
+     filter(l_commitdate < l_receiptdate) |>
+     select(l_orderkey)
+ 
+   o <- orders |>
+     select(o_orderkey, o_orderdate, o_orderpriority) |>
+     filter(o_orderdate >= "1993-07-01", o_orderdate < "1993-10-01") |>
+     select(o_orderkey, o_orderpriority)
+ 
+   # distinct after join, tested and indeed faster
+   lo <- inner_join(l, o, by = c("l_orderkey" = "o_orderkey")) |>
+     distinct() |>
+     select(o_orderpriority)
+ 
+   aggr <- lo |>
+     group_by(o_orderpriority) |>
+     summarise(order_count = n()) |>
+     arrange(o_orderpriority)
+   
+   aggr
+ }
> 
> test_dplyr_q[[5]] <- function() {
+   nr <- inner_join(
+     nation |>
+       select(n_nationkey, n_regionkey, n_name),
+     region |>
+       select(r_regionkey, r_name) |>
+       filter(r_name == "ASIA"),
+     by = c("n_regionkey" = "r_regionkey")
+   ) |>
+     select(n_nationkey, n_name)
+ 
+   snr <- inner_join(
+     supplier |>
+       select(s_suppkey, s_nationkey),
+     nr,
+     by = c("s_nationkey" = "n_nationkey")
+   ) |>
+     select(s_suppkey, s_nationkey, n_name)
+ 
+   lsnr <- inner_join(
+     lineitem |> select(l_suppkey, l_orderkey, l_extendedprice, l_discount), 
+     snr, by = c("l_suppkey" = "s_suppkey"))
+ 
+   o <- orders |> 
+     select(o_orderdate, o_orderkey, o_custkey) |> 
+     filter(o_orderdate >= "1994-01-01", o_orderdate < "1995-01-01") |> 
+     select(o_orderkey, o_custkey)
+ 
+   oc <- inner_join(o, customer |> select(c_custkey, c_nationkey), 
+     by = c("o_custkey" = "c_custkey")) |> 
+   select(o_orderkey, c_nationkey)
+ 
+   lsnroc <- inner_join(lsnr, oc, 
+     by = c("l_orderkey" = "o_orderkey", "s_nationkey" = "c_nationkey")) |> 
+   select(l_extendedprice, l_discount, n_name)
+ 
+   aggr <- lsnroc |>
+     mutate(volume=l_extendedprice * (1 - l_discount)) |>
+     group_by(n_name) |>
+     summarise(revenue = sum(volume)) |>
+     #arrange(desc(revenue)) # TODO
+     arrange(revenue)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[6]] <- function() {
+   lineitem |>
+     select(l_shipdate, l_extendedprice, l_discount, l_quantity) |>
+     filter(l_shipdate >= "1994-01-01", 
+         l_shipdate < "1995-01-01", 
+         l_discount >= 0.05, 
+         l_discount <= 0.07, 
+         l_quantity < 24) |>
+     select(l_extendedprice, l_discount) |>
+     summarise(revenue = sum(l_extendedprice * l_discount))
+ }
> 
> test_dplyr_q[[7]] <- function() {
+   sn <- inner_join(
+     supplier |> 
+         select(s_nationkey, s_suppkey), 
+     nation |> 
+         select(n1_nationkey = n_nationkey, n1_name = n_name) |> 
+         #filter(n1_name %in% c("FRANCE", "GERMANY")),  TODO
+         filter(n1_name == "FRANCE" || n1_name == "GERMANY"),
+     by = c("s_nationkey" = "n1_nationkey")) |> 
+     select(s_suppkey, n1_name)
+ 
+   cn <- inner_join(
+     customer |> 
+         select(c_custkey, c_nationkey), 
+     nation |> 
+         select(n2_nationkey = n_nationkey, n2_name = n_name) |> 
+         #filter(n2_name %in% c("FRANCE", "GERMANY")),
+         filter(n2_name == "FRANCE" || n2_name == "GERMANY"),
+     by = c("c_nationkey" = "n2_nationkey")) |> 
+     select(c_custkey, n2_name)
+ 
+   cno <- inner_join(
+     orders |> 
+         select(o_custkey, o_orderkey), 
+     cn, by = c("o_custkey" = "c_custkey")) |> 
+     select(o_orderkey, n2_name)
+ 
+   cnol <- inner_join(
+     lineitem |> 
+         select(l_orderkey, l_suppkey, l_shipdate, l_extendedprice, l_discount) |> 
+         filter(l_shipdate >= "1995-01-01", l_shipdate <= "1996-12-31"), 
+     cno, 
+     by = c("l_orderkey" = "o_orderkey")) |> 
+     select(l_suppkey, l_shipdate, l_extendedprice, l_discount, n2_name)
+ 
+   all <- inner_join(cnol, sn, by = c("l_suppkey" = "s_suppkey"))
+ 
+   aggr <- all |>
+     filter((n1_name == "FRANCE" & n2_name == "GERMANY") |
+         (n1_name == "GERMANY" & n2_name == "FRANCE")) |>
+     mutate(
+         supp_nation = n1_name, 
+         cust_nation = n2_name, 
+         l_year = as.integer(strftime(l_shipdate, "%Y")),
+         volume = l_extendedprice * (1 - l_discount)) |>
+     select(supp_nation, cust_nation, l_year, volume) |>
+     group_by(supp_nation, cust_nation, l_year) |>
+     summarise(revenue = sum(volume)) |>
+     arrange(supp_nation, cust_nation, l_year)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[8]] <- function() {
+   nr <- inner_join(
+     nation |> 
+         select(n1_nationkey = n_nationkey, n1_regionkey = n_regionkey), 
+     region |> 
+         select(r_regionkey, r_name) |> 
+         filter(r_name == "AMERICA") |> 
+         select(r_regionkey), 
+     by = c("n1_regionkey" = "r_regionkey")) |> 
+     select(n1_nationkey)
+ 
+   cnr <- inner_join(
+     customer |> 
+         select(c_custkey, c_nationkey), 
+         nr, by = c("c_nationkey" = "n1_nationkey")) |> 
+     select(c_custkey)
+   
+   ocnr <- inner_join(
+     orders |> 
+         select(o_orderkey, o_custkey, o_orderdate) |> 
+         filter(o_orderdate >= "1995-01-01", o_orderdate <= "1996-12-31"), 
+     cnr, by = c("o_custkey" = "c_custkey")) |> 
+     select(o_orderkey, o_orderdate)
+ 
+   locnr <- inner_join(
+     lineitem |> 
+         select(l_orderkey, l_partkey, l_suppkey, l_extendedprice, l_discount), 
+         ocnr, by=c("l_orderkey" = "o_orderkey")) |> 
+     select(l_partkey, l_suppkey, l_extendedprice, l_discount, o_orderdate)
+ 
+   locnrp <- inner_join(locnr, 
+     part |> 
+         select(p_partkey, p_type) |> 
+         filter(p_type == "ECONOMY ANODIZED STEEL") |> 
+         select(p_partkey), 
+     by = c("l_partkey" = "p_partkey")) |> 
+     select(l_suppkey, l_extendedprice, l_discount, o_orderdate)
+ 
+   locnrps <- inner_join(locnrp, 
+     supplier |> 
+         select(s_suppkey, s_nationkey), 
+     by = c("l_suppkey" = "s_suppkey")) |> 
+     select(l_extendedprice, l_discount, o_orderdate, s_nationkey)
+ 
+   all <- inner_join(locnrps, 
+     nation |> 
+         select(n2_nationkey = n_nationkey, n2_name = n_name), 
+     by = c("s_nationkey" = "n2_nationkey")) |> 
+     select(l_extendedprice, l_discount, o_orderdate, n2_name)
+ 
+   aggr <- all |>
+     mutate(
+         o_year = as.integer(strftime(o_orderdate, "%Y")),
+         volume = l_extendedprice * (1 - l_discount), 
+         nation = n2_name) |>
+     select(o_year, volume, nation) |>
+     group_by(o_year) |>
+     summarise(mkt_share = sum(ifelse(nation == "BRAZIL", volume, 0)) / sum(volume)) |>
+     arrange(o_year)
+   aggr
+ }
> 
> test_dplyr_q[[9]] <- function() {
+   p <- part |> 
+     select(p_name, p_partkey) |> 
+     filter(grepl(".*green.*", p_name)) |>
+     select(p_partkey)
+ 
+   psp <- inner_join(
+     partsupp |> 
+         select(ps_suppkey, ps_partkey, ps_supplycost), 
+     p, by = c("ps_partkey" = "p_partkey"))
+ 
+   sn <- inner_join(
+     supplier |> 
+         select(s_suppkey, s_nationkey), 
+     nation |> 
+         select(n_nationkey, n_name), 
+     by = c("s_nationkey" = "n_nationkey")) |> 
+     select(s_suppkey, n_name)
+ 
+   pspsn <- inner_join(psp, sn, by = c("ps_suppkey" = "s_suppkey"))
+ 
+   lpspsn <- inner_join(
+     lineitem |> 
+         select(l_suppkey, l_partkey, l_orderkey, l_extendedprice, l_discount, l_quantity),
+     pspsn, 
+     by = c("l_suppkey" = "ps_suppkey", "l_partkey" = "ps_partkey")) |> 
+     select(l_orderkey, l_extendedprice, l_discount, l_quantity, ps_supplycost, n_name)
+ 
+   all <- inner_join(
+     orders |> 
+       select(o_orderkey, o_orderdate), 
+     lpspsn,   
+     by = c("o_orderkey"= "l_orderkey" )) |> 
+     select(l_extendedprice, l_discount, l_quantity, ps_supplycost, n_name, o_orderdate)
+ 
+   aggr <- all |>
+     mutate(
+         nation = n_name, 
+         o_year = as.integer(strftime(o_orderdate, "%Y")),
+         amount = l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity) |>
+     select(nation, o_year, amount) |>
+     group_by(nation, o_year) |>
+     summarise(sum_profit = sum(amount)) |>
+     #arrange(nation, desc(o_year)) TODO
+     arrange(nation, o_year)
+ 
+   aggr
+ }
> 
> test_dplyr_q[[10]] <- function() {
+   l <- lineitem |> 
+     select(l_orderkey, l_returnflag, l_extendedprice, l_discount) |> 
+     filter(l_returnflag == "R") |> 
+     select(l_orderkey, l_extendedprice, l_discount)
+   
+   o <- orders |> 
+     select(o_orderkey, o_custkey, o_orderdate) |> 
+     filter(o_orderdate >= "1993-10-01", o_orderdate < "1994-01-01") |> 
+     select(o_orderkey, o_custkey)
+   
+   lo <- inner_join(l, o, 
+     by = c("l_orderkey" = "o_orderkey")) |> 
+     select(l_extendedprice, l_discount, o_custkey)
+   # first aggregate, then join with customer/nation, 
+   # otherwise we need to aggr over lots of cols
+   
+   lo_aggr <- lo |> mutate(volume=l_extendedprice * (1 - l_discount)) |> 
+     group_by(o_custkey) |> 
+     summarise(revenue = sum(volume))
+   
+   c <- customer |> 
+     select(c_custkey, c_nationkey, c_name, c_acctbal, c_phone, c_address, c_comment)
+   
+   loc <- inner_join(lo_aggr, c, by = c("o_custkey" = "c_custkey"))
+   
+   locn <- inner_join(loc, nation |> select(n_nationkey, n_name), 
+     by = c("c_nationkey" = "n_nationkey"))
+   
+   res <- locn |>
+     select(o_custkey, c_name, revenue, c_acctbal, n_name, 
+         c_address, c_phone, c_comment) |>
+     #arrange(desc(revenue)) |> TODO
+         arrange(revenue) |>
+ 
+     head(20)
+   
+   res
+ }
> 
> 
> invisible(lapply(test_dplyr_q, function(f) {
+   print(f)
+   rel <- f()
+   print(rel)
+   print(duckdb::rel_explain(rel))
+   print(as.data.frame(rel))
+   NULL
+ }))
function () 
{
    arrange(summarise(group_by(select(filter(select(lineitem, 
        l_shipdate, l_returnflag, l_linestatus, l_quantity, l_extendedprice, 
        l_discount, l_tax), l_shipdate <= "1998-09-02"), l_returnflag, 
        l_linestatus, l_quantity, l_extendedprice, l_discount, 
        l_tax), l_returnflag, l_linestatus), sum_qty = sum(l_quantity), 
        sum_base_price = sum(l_extendedprice), sum_disc_price = sum(l_extendedprice * 
            (1 - l_discount)), sum_charge = sum(l_extendedprice * 
            (1 - l_discount) * (1 + l_tax)), avg_qty = mean(l_quantity), 
        avg_price = mean(l_extendedprice), avg_disc = mean(l_discount), 
        count_order = n()), l_returnflag, l_linestatus)
}
┌───────────────────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    dataframe_1827609411   │
│     .l_returnflag ASC     │
│    dataframe_1827609411   │
│     .l_linestatus ASC     │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│          sum(#2)          │
│          sum(#3)          │
│          sum(#4)          │
│          sum(#5)          │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│ *(#4, +(1.000000, l_tax)) │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│   *(l_extendedprice, -(1  │
│   .000000, l_discount))   │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│l_shipdate <= '1998-09-02':│
│           :DATE           │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         data.frame        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│        l_returnflag       │
│        l_linestatus       │
│         l_shipdate        │
└───────────────────────────┘                             
NULL
[38;5;246m# A tibble: 4 × 10[39m
  l_returnflag l_linestatus  sum_qty sum_base_price sum_disc_price    sum_charge
  [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<chr>[39m[23m           [3m[38;5;246m<dbl>[39m[23m          [3m[38;5;246m<dbl>[39m[23m          [3m[38;5;246m<dbl>[39m[23m         [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m N            O            74[4m4[24m[4m7[24m[4m6[24m040  [4m1[24m[4m1[24m[4m1[24m701[4m7[24m[4m2[24m[4m9[24m698.  [4m1[24m[4m0[24m[4m6[24m118[4m2[24m[4m3[24m[4m0[24m308. [4m1[24m[4m1[24m[4m0[24m367[4m0[24m[4m4[24m[4m3[24m872.
[38;5;250m2[39m N            F              [4m9[24m[4m9[24m[4m1[24m417    [4m1[24m487[4m5[24m[4m0[24m[4m4[24m710.    [4m1[24m413[4m0[24m[4m8[24m[4m2[24m168.   [4m1[24m469[4m6[24m[4m4[24m[4m9[24m223.
[38;5;250m3[39m R            F            37[4m7[24m[4m1[24m[4m9[24m753   [4m5[24m[4m6[24m568[4m0[24m[4m4[24m[4m1[24m381.   [4m5[24m[4m3[24m741[4m2[24m[4m9[24m[4m2[24m685.  [4m5[24m[4m5[24m889[4m6[24m[4m1[24m[4m9[24m120.
[38;5;250m4[39m A            F            37[4m7[24m[4m3[24m[4m4[24m107   [4m5[24m[4m6[24m586[4m5[24m[4m5[24m[4m4[24m401.   [4m5[24m[4m3[24m758[4m2[24m[4m5[24m[4m7[24m135.  [4m5[24m[4m5[24m909[4m0[24m[4m6[24m[4m5[24m223.
[38;5;246m# … with 4 more variables: avg_qty <dbl>, avg_price <dbl>, avg_disc <dbl>,[39m
[38;5;246m#   count_order <dbl>[39m
function () 
{
    ps <- select(partsupp, ps_partkey, ps_suppkey, ps_supplycost)
    p <- select(filter(select(part, p_partkey, p_type, p_size, 
        p_mfgr), p_size == 15, grepl(".*BRASS$", p_type)), p_partkey, 
        p_mfgr)
    psp <- inner_join(ps, p, by = c(ps_partkey = "p_partkey"))
    sp <- select(supplier, s_suppkey, s_nationkey, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    psps <- select(inner_join(psp, sp, by = c(ps_suppkey = "s_suppkey")), 
        ps_partkey, ps_supplycost, p_mfgr, s_nationkey, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    nr <- select(inner_join(nation, filter(region, r_name == 
        "EUROPE"), by = c(n_regionkey = "r_regionkey")), n_nationkey, 
        n_name)
    pspsnr <- select(inner_join(psps, nr, by = c(s_nationkey = "n_nationkey")), 
        ps_partkey, ps_supplycost, p_mfgr, n_name, s_acctbal, 
        s_name, s_address, s_phone, s_comment)
    aggr <- summarise(group_by(pspsnr, ps_partkey), min_ps_supplycost = min(ps_supplycost))
    sj <- inner_join(pspsnr, aggr, by = c(ps_partkey = "ps_partkey", 
        ps_supplycost = "min_ps_supplycost"))
    res <- head(arrange(select(sj, s_acctbal, s_name, n_name, 
        ps_partkey, p_mfgr, s_address, s_phone, s_comment), s_acctbal, 
        n_name, s_name, ps_partkey), 100)
    res
}
┌─────────────────────┐                                                                                                                                                                                                               
│        TOP_N        │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       Top 100       │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│  relation.s_acctbal │                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
│ relation.n_name ASC │                                                                                                                                                                                                               
│ relation.s_name ASC │                                                                                                                                                                                                               
│ relation.ps_partkey │                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      s_acctbal      │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
│        n_name       │                                                                                                                                                                                                               
│      ps_partkey     │                                                                                                                                                                                                               
│        p_mfgr       │                                                                                                                                                                                                               
│      s_address      │                                                                                                                                                                                                               
│       s_phone       │                                                                                                                                                                                                               
│      s_comment      │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      ps_partkey     │                                                                                                                                                                                                               
│        p_mfgr       │                                                                                                                                                                                                               
│        n_name       │                                                                                                                                                                                                               
│      s_acctbal      │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
│      s_address      │                                                                                                                                                                                                               
│       s_phone       │                                                                                                                                                                                                               
│      s_comment      │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      HASH_JOIN      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        INNER        │                                                                                                                                                                                                               
│    ps_supplycost    ├───────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                       
│  =min_ps_supplycost │                                                                                                       │                                                                                                       
│ps_partkey=ps_partkey│                                                                                                       │                                                                                                       
└──────────┬──────────┘                                                                                                       │                                                                                                                              
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      PROJECTION     │                                                                                            │    HASH_GROUP_BY    │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│      ps_partkey     │                                                                                            │          #0         │                                                                                            
│    ps_supplycost    │                                                                                            │       min(#1)       │                                                                                            
│        p_mfgr       │                                                                                            │                     │                                                                                            
│        n_name       │                                                                                            │                     │                                                                                            
│      s_acctbal      │                                                                                            │                     │                                                                                            
│        s_name       │                                                                                            │                     │                                                                                            
│      s_address      │                                                                                            │                     │                                                                                            
│       s_phone       │                                                                                            │                     │                                                                                            
│      s_comment      │                                                                                            │                     │                                                                                            
└──────────┬──────────┘                                                                                            └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      PROJECTION     │                                                                                            │      PROJECTION     │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│      ps_partkey     │                                                                                            │      ps_partkey     │                                                                                            
│    ps_supplycost    │                                                                                            │    ps_supplycost    │                                                                                            
│        p_mfgr       │                                                                                            │                     │                                                                                            
│      s_acctbal      │                                                                                            │                     │                                                                                            
│        s_name       │                                                                                            │                     │                                                                                            
│      s_address      │                                                                                            │                     │                                                                                            
│       s_phone       │                                                                                            │                     │                                                                                            
│      s_comment      │                                                                                            │                     │                                                                                            
│        n_name       │                                                                                            │                     │                                                                                            
└──────────┬──────────┘                                                                                            └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      HASH_JOIN      │                                                                                            │      PROJECTION     │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│        INNER        ├─────────────────────────────────────────────────────────┐                                  │      ps_partkey     │                                                                                            
│     s_nationkey     │                                                         │                                  │    ps_supplycost    │                                                                                            
│     =n_nationkey    │                                                         │                                  │                     │                                                                                            
└──────────┬──────────┘                                                         │                                  └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐                                                                                            
│      PROJECTION     │                                              │      PROJECTION     │                       │      HASH_JOIN      │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│      ps_partkey     │                                              │     n_nationkey     │                       │        INNER        │                                                                                            
│    ps_supplycost    │                                              │        n_name       │                       │     s_nationkey     │                                                                                            
│        p_mfgr       │                                              │                     │                       │     =n_nationkey    │                                                                                            
│     s_nationkey     │                                              │                     │                       │                     ├─────────────────────────────────────────────────────────┐                                  
│      s_acctbal      │                                              │                     │                       │                     │                                                         │                                  
│        s_name       │                                              │                     │                       │                     │                                                         │                                  
│      s_address      │                                              │                     │                       │                     │                                                         │                                  
│       s_phone       │                                              │                     │                       │                     │                                                         │                                  
│      s_comment      │                                              │                     │                       │                     │                                                         │                                  
└──────────┬──────────┘                                              └──────────┬──────────┘                       └──────────┬──────────┘                                                         │                                                         
┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       
│      HASH_JOIN      │                                              │      HASH_JOIN      │                       │      PROJECTION     │                                              │      PROJECTION     │                       
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       
│        INNER        ├──────────────────────────────────┐           │        INNER        ├───────────┐           │      ps_partkey     │                                              │     n_nationkey     │                       
│ ps_suppkey=s_suppkey│                                  │           │     n_regionkey     │           │           │    ps_supplycost    │                                              │                     │                       
│                     │                                  │           │     =r_regionkey    │           │           │     s_nationkey     │                                              │                     │                       
└──────────┬──────────┘                                  │           └──────────┬──────────┘           │           └──────────┬──────────┘                                              └──────────┬──────────┘                                              
┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       
│      HASH_JOIN      │                       │      PROJECTION     ││   R_DATAFRAME_SCAN  ││      PROJECTION     ││      HASH_JOIN      │                                              │      HASH_JOIN      │                       
│   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       
│        INNER        │                       │      s_suppkey      ││      data.frame     ││          #0         ││        INNER        │                                              │        INNER        │                       
│ ps_partkey=p_partkey│                       │     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││ ps_suppkey=s_suppkey│                                              │     n_regionkey     │                       
│                     ├───────────┐           │      s_acctbal      ││     n_nationkey     ││                     ││                     ├──────────────────────────────────┐           │     =r_regionkey    ├───────────┐           
│                     │           │           │        s_name       ││        n_name       ││                     ││                     │                                  │           │                     │           │           
│                     │           │           │      s_address      ││     n_regionkey     ││                     ││                     │                                  │           │                     │           │           
│                     │           │           │       s_phone       ││                     ││                     ││                     │                                  │           │                     │           │           
│                     │           │           │      s_comment      ││                     ││                     ││                     │                                  │           │                     │           │           
└──────────┬──────────┘           │           └──────────┬──────────┘└─────────────────────┘└──────────┬──────────┘└──────────┬──────────┘                                  │           └──────────┬──────────┘           │                                  
┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐
│   R_DATAFRAME_SCAN  ││      PROJECTION     ││   R_DATAFRAME_SCAN  │                       │        FILTER       ││      PROJECTION     │                       │   R_DATAFRAME_SCAN  ││   R_DATAFRAME_SCAN  ││      PROJECTION     │
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │
│      data.frame     ││          #0         ││      data.frame     │                       │   r_name = EUROPE   ││      ps_partkey     │                       │      data.frame     ││      data.frame     ││          #0         │
│   ─ ─ ─ ─ ─ ─ ─ ─   ││          #1         ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││      ps_suppkey     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │
│      ps_partkey     ││                     ││      s_suppkey      │                       │                     ││    ps_supplycost    │                       │      s_suppkey      ││     n_nationkey     ││                     │
│      ps_suppkey     ││                     ││        s_name       │                       │                     ││                     │                       │     s_nationkey     ││     n_regionkey     ││                     │
│    ps_supplycost    ││                     ││      s_address      │                       │                     ││                     │                       │                     ││                     ││                     │
│                     ││                     ││     s_nationkey     │                       │                     ││                     │                       │                     ││                     ││                     │
│                     ││                     ││       s_phone       │                       │                     ││                     │                       │                     ││                     ││                     │
│                     ││                     ││      s_acctbal      │                       │                     ││                     │                       │                     ││                     ││                     │
│                     ││                     ││      s_comment      │                       │                     ││                     │                       │                     ││                     ││                     │
└─────────────────────┘└──────────┬──────────┘└─────────────────────┘                       └──────────┬──────────┘└──────────┬──────────┘                       └─────────────────────┘└─────────────────────┘└──────────┬──────────┘                       
                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐
                       │        FILTER       │                                              │   R_DATAFRAME_SCAN  ││      HASH_JOIN      │                                                                     │        FILTER       │
                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │
                       │CAST(p_size AS DOUBLE│                                              │      data.frame     ││        INNER        │                                                                     │   r_name = EUROPE   │
                       │  ) = 15.000000 AND  │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││ ps_partkey=p_partkey├───────────┐                                                         │                     │
                       │ suffix(CAST(p_t...  │                                              │     r_regionkey     ││                     │           │                                                         │                     │
                       │  VARCHAR), 'BRASS') │                                              │        r_name       ││                     │           │                                                         │                     │
                       └──────────┬──────────┘                                              └─────────────────────┘└──────────┬──────────┘           │                                                         └──────────┬──────────┘                       
                       ┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐
                       │   R_DATAFRAME_SCAN  │                                                                     │   R_DATAFRAME_SCAN  ││      PROJECTION     │                                              │   R_DATAFRAME_SCAN  │
                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │
                       │      data.frame     │                                                                     │      data.frame     ││          #0         │                                              │      data.frame     │
                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │
                       │      p_partkey      │                                                                     │      ps_partkey     ││                     │                                              │     r_regionkey     │
                       │        p_mfgr       │                                                                     │      ps_suppkey     ││                     │                                              │        r_name       │
                       │        p_type       │                                                                     │    ps_supplycost    ││                     │                                              │                     │
                       │        p_size       │                                                                     │                     ││                     │                                              │                     │
                       └─────────────────────┘                                                                     └─────────────────────┘└──────────┬──────────┘                                              └─────────────────────┘                       
                                                                                                                                          ┌──────────┴──────────┐                                                                     
                                                                                                                                          │        FILTER       │                                                                     
                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     
                                                                                                                                          │CAST(p_size AS DOUBLE│                                                                     
                                                                                                                                          │  ) = 15.000000 AND  │                                                                     
                                                                                                                                          │ suffix(CAST(p_t...  │                                                                     
                                                                                                                                          │  VARCHAR), 'BRASS') │                                                                     
                                                                                                                                          └──────────┬──────────┘                                                                                            
                                                                                                                                          ┌──────────┴──────────┐                                                                     
                                                                                                                                          │   R_DATAFRAME_SCAN  │                                                                     
                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     
                                                                                                                                          │      data.frame     │                                                                     
                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     
                                                                                                                                          │      p_partkey      │                                                                     
                                                                                                                                          │        p_type       │                                                                     
                                                                                                                                          │        p_size       │                                                                     
                                                                                                                                          └─────────────────────┘                                                                                            
NULL
[38;5;246m# A tibble: 100 × 8[39m
   s_acctbal s_name  n_name  ps_partkey p_mfgr  s_address  s_phone s_comment    
       [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<int>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m      [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        
[38;5;250m 1[39m     -[31m986[39m[31m.[39m Suppli… FRANCE      [4m1[24m[4m0[24m[4m3[24m626 Manufa… [38;5;246m"[39mUT0ZxJ9v… 16-568… [38;5;246m"[39mclosely bli…
[38;5;250m 2[39m     -[31m970[39m[31m.[39m Suppli… UNITED…     [4m1[24m[4m1[24m[4m7[24m143 Manufa… [38;5;246m"[39m 0PDrXE2… 33-455… [38;5;246m"[39m foxes. fur…
[38;5;250m 3[39m     -[31m964[39m[31m.[39m Suppli… RUSSIA       [4m2[24m[4m0[24m064 Manufa… [38;5;246m"[39mqzqDj7E8… 32-444… [38;5;246m"[39ml ideas wak…
[38;5;250m 4[39m     -[31m927[39m[31m.[39m Suppli… UNITED…     [4m1[24m[4m5[24m[4m0[24m998 Manufa… [38;5;246m"[39mVXx4Mkb5… 33-482… [38;5;246m"[39my unusual a…
[38;5;250m 5[39m     -[31m906[39m[31m.[39m Suppli… GERMANY      [4m7[24m[4m0[24m083 Manufa… [38;5;246m"[39m0R4CnsF1… 17-497… [38;5;246m"[39mbold deposi…
[38;5;250m 6[39m     -[31m898[39m[31m.[39m Suppli… UNITED…      [4m9[24m[4m8[24m568 Manufa… [38;5;246m"[39mKr6p2Rrv… 33-984… [38;5;246m"[39mickly pendi…
[38;5;250m 7[39m     -[31m898[39m[31m.[39m Suppli… UNITED…     [4m1[24m[4m2[24m[4m1[24m074 Manufa… [38;5;246m"[39mKr6p2Rrv… 33-984… [38;5;246m"[39mickly pendi…
[38;5;250m 8[39m     -[31m898[39m[31m.[39m Suppli… GERMANY     [4m1[24m[4m0[24m[4m2[24m158 Manufa… [38;5;246m"[39moJ1v7ZKU… 17-496… [38;5;246m"[39m along the …
[38;5;250m 9[39m     -[31m898[39m[31m.[39m Suppli… GERMANY     [4m1[24m[4m8[24m[4m4[24m604 Manufa… [38;5;246m"[39moJ1v7ZKU… 17-496… [38;5;246m"[39m along the …
[38;5;250m10[39m     -[31m824[39m[31m.[39m Suppli… RUSSIA      [4m1[24m[4m2[24m[4m5[24m868 Manufa… [38;5;246m"[39m5uc7oPCM… 32-328… [38;5;246m"[39mully pendin…
[38;5;246m# … with 90 more rows[39m
function () 
{
    oc <- select(inner_join(filter(select(orders, o_orderkey, 
        o_custkey, o_orderdate, o_shippriority), o_orderdate < 
        "1995-03-15"), filter(select(customer, c_custkey, c_mktsegment), 
        c_mktsegment == "BUILDING"), by = c(o_custkey = "c_custkey")), 
        o_orderkey, o_orderdate, o_shippriority)
    loc <- inner_join(select(filter(select(lineitem, l_orderkey, 
        l_shipdate, l_extendedprice, l_discount), l_shipdate > 
        "1995-03-15"), l_orderkey, l_extendedprice, l_discount), 
        oc, by = c(l_orderkey = "o_orderkey"))
    aggr <- head(arrange(select(summarise(group_by(mutate(loc, 
        volume = l_extendedprice * (1 - l_discount)), l_orderkey, 
        o_orderdate, o_shippriority), revenue = sum(volume)), 
        l_orderkey, revenue, o_orderdate, o_shippriority), revenue, 
        o_orderdate), 10)
    aggr
}
┌───────────────────────────┐                                                          
│           TOP_N           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           Top 10          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│    relation.revenue ASC   │                                                          
│  relation.o_orderdate ASC │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│           volume          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│           volume          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           ├──────────────┐                                           
│   l_orderkey=o_orderkey   │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         PROJECTION        ││         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            ││         o_orderkey        │                             
│             #1            ││        o_orderdate        │                             
│             #2            ││       o_shippriority      │                             
└─────────────┬─────────────┘└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│           FILTER          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ l_shipdate > '1995-03-15':││           INNER           ├──────────────┐              
│           :DATE           ││    o_custkey=c_custkey    │              │              
└─────────────┬─────────────┘└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│      R_DATAFRAME_SCAN     ││           FILTER          ││         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         data.frame        ││o_orderdate < '1995-03-15':││             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││           :DATE           ││                           │
│         l_orderkey        ││                           ││                           │
│      l_extendedprice      ││                           ││                           │
│         l_discount        ││                           ││                           │
│         l_shipdate        ││                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │      R_DATAFRAME_SCAN     ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         data.frame        ││  c_mktsegment = BUILDING  │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││                           │
                             │         o_custkey         ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │      R_DATAFRAME_SCAN     │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         data.frame        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │        c_mktsegment       │
                                                          └───────────────────────────┘                             
NULL
[38;5;246m# A tibble: 10 × 4[39m
   l_orderkey revenue o_orderdate o_shippriority
        [3m[38;5;246m<int>[39m[23m   [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<date>[39m[23m               [3m[38;5;246m<int>[39m[23m
[38;5;250m 1[39m    3[4m2[24m[4m8[24m[4m3[24m971    851. 1994-12-27               0
[38;5;250m 2[39m     [4m6[24m[4m1[24m[4m7[24m767    902. 1995-02-17               0
[38;5;250m 3[39m    4[4m8[24m[4m1[24m[4m0[24m887    947. 1994-12-31               0
[38;5;250m 4[39m    4[4m2[24m[4m7[24m[4m6[24m512    961. 1994-12-31               0
[38;5;250m 5[39m    4[4m0[24m[4m9[24m[4m6[24m903    967. 1995-01-31               0
[38;5;250m 6[39m    2[4m6[24m[4m7[24m[4m4[24m948   [4m1[24m009. 1995-02-05               0
[38;5;250m 7[39m    1[4m7[24m[4m9[24m[4m6[24m705   [4m1[24m019. 1995-01-03               0
[38;5;250m 8[39m    1[4m0[24m[4m3[24m[4m3[24m956   [4m1[24m061. 1994-12-23               0
[38;5;250m 9[39m    5[4m9[24m[4m9[24m[4m6[24m519   [4m1[24m069. 1994-12-06               0
[38;5;250m10[39m    1[4m0[24m[4m2[24m[4m3[24m046   [4m1[24m073. 1994-12-25               0
function () 
{
    l <- select(filter(select(lineitem, l_orderkey, l_commitdate, 
        l_receiptdate), l_commitdate < l_receiptdate), l_orderkey)
    o <- select(filter(select(orders, o_orderkey, o_orderdate, 
        o_orderpriority), o_orderdate >= "1993-07-01", o_orderdate < 
        "1993-10-01"), o_orderkey, o_orderpriority)
    lo <- select(distinct(inner_join(l, o, by = c(l_orderkey = "o_orderkey"))), 
        o_orderpriority)
    aggr <- arrange(summarise(group_by(lo, o_orderpriority), 
        order_count = n()), o_orderpriority)
    aggr
}
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  relation.o_orderpriority │                             
│             ASC           │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      o_orderpriority      │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      o_orderpriority      │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│   inner_join_lhs_5384972  │                             
│        .l_orderkey        │                             
│   inner_join_rhs_7104270  │                             
│      .o_orderpriority     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           ├──────────────┐              
│   l_orderkey=o_orderkey   │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         PROJECTION        ││         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            ││             #0            │
│                           ││             #2            │
└─────────────┬─────────────┘└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│       l_commitdate <      ││ o_orderdate BETWEEN '1993 │
│        l_receiptdate      ││-07-01'::DATE AND '199...  │
│                           ││          '::DATE          │
└─────────────┬─────────────┘└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│      R_DATAFRAME_SCAN     ││      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         data.frame        ││         data.frame        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_orderkey        ││         o_orderkey        │
│        l_commitdate       ││        o_orderdate        │
│       l_receiptdate       ││      o_orderpriority      │
└───────────────────────────┘└───────────────────────────┘                             
NULL
[38;5;246m# A tibble: 5 × 2[39m
  o_orderpriority order_count
  [3m[38;5;246m<chr>[39m[23m                 [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m 5-LOW                 [4m1[24m[4m0[24m487
[38;5;250m2[39m 2-HIGH                [4m1[24m[4m0[24m476
[38;5;250m3[39m 3-MEDIUM              [4m1[24m[4m0[24m410
[38;5;250m4[39m 4-NOT SPECIFIED       [4m1[24m[4m0[24m556
[38;5;250m5[39m 1-URGENT              [4m1[24m[4m0[24m594
function () 
{
    nr <- select(inner_join(select(nation, n_nationkey, n_regionkey, 
        n_name), filter(select(region, r_regionkey, r_name), 
        r_name == "ASIA"), by = c(n_regionkey = "r_regionkey")), 
        n_nationkey, n_name)
    snr <- select(inner_join(select(supplier, s_suppkey, s_nationkey), 
        nr, by = c(s_nationkey = "n_nationkey")), s_suppkey, 
        s_nationkey, n_name)
    lsnr <- inner_join(select(lineitem, l_suppkey, l_orderkey, 
        l_extendedprice, l_discount), snr, by = c(l_suppkey = "s_suppkey"))
    o <- select(filter(select(orders, o_orderdate, o_orderkey, 
        o_custkey), o_orderdate >= "1994-01-01", o_orderdate < 
        "1995-01-01"), o_orderkey, o_custkey)
    oc <- select(inner_join(o, select(customer, c_custkey, c_nationkey), 
        by = c(o_custkey = "c_custkey")), o_orderkey, c_nationkey)
    lsnroc <- select(inner_join(lsnr, oc, by = c(l_orderkey = "o_orderkey", 
        s_nationkey = "c_nationkey")), l_extendedprice, l_discount, 
        n_name)
    aggr <- arrange(summarise(group_by(mutate(lsnroc, volume = l_extendedprice * 
        (1 - l_discount)), n_name), revenue = sum(volume)), revenue)
    aggr
}
┌───────────────────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│  sum(relation.volume) ASC │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│      l_extendedprice      │                                                                                                                                                 
│         l_discount        │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│   l_orderkey=o_orderkey   │                                                                                                     │                                           
│  s_nationkey=c_nationkey  │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                       │         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_orderkey        │                                                                                       │         o_orderkey        │                             
│      l_extendedprice      │                                                                                       │        c_nationkey        │                             
│         l_discount        │                                                                                       │                           │                             
│        s_nationkey        │                                                                                       │                           │                             
│           n_name          │                                                                                       │                           │                             
└─────────────┬─────────────┘                                                                                       └─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           ├──────────────┐                                                                        │           INNER           ├──────────────┐              
│    l_suppkey=s_suppkey    │              │                                                                        │    o_custkey=c_custkey    │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         PROJECTION        ││         HASH_JOIN         │                                                          │         PROJECTION        ││      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││           INNER           │                                                          │             #0            ││         data.frame        │
│         l_orderkey        ││  s_nationkey=n_nationkey  ├──────────────┐                                           │             #1            ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││                           │              │                                           │                           ││         c_custkey         │
│         l_discount        ││                           │              │                                           │                           ││        c_nationkey        │
└─────────────┬─────────────┘└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│      R_DATAFRAME_SCAN     ││      R_DATAFRAME_SCAN     ││         PROJECTION        │                             │           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         data.frame        ││         data.frame        ││        n_nationkey        │                             │ o_orderdate BETWEEN '1994 │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││           n_name          │                             │-01-01'::DATE AND '199...  │                             
│         l_orderkey        ││         s_suppkey         ││                           │                             │          '::DATE          │                             
│         l_suppkey         ││        s_nationkey        ││                           │                             │                           │                             
│      l_extendedprice      ││                           ││                           │                             │                           │                             
│         l_discount        ││                           ││                           │                             │                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │      R_DATAFRAME_SCAN     │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │         data.frame        │                             
                                                          │  n_regionkey=r_regionkey  ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │                           │              │              │         o_orderkey        │                             
                                                          │                           │              │              │         o_custkey         │                             
                                                          │                           │              │              │        o_orderdate        │                             
                                                          └─────────────┬─────────────┘              │              └───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        ││         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │        n_nationkey        ││             #0            │                                                          
                                                          │        n_regionkey        ││                           │                                                          
                                                          │           n_name          ││                           │                                                          
                                                          └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │      R_DATAFRAME_SCAN     ││           FILTER          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         data.frame        ││       r_name = ASIA       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │        n_nationkey        ││                           │                                                          
                                                          │           n_name          ││                           │                                                          
                                                          │        n_regionkey        ││                           │                                                          
                                                          └───────────────────────────┘└─────────────┬─────────────┘                                                                                       
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │      R_DATAFRAME_SCAN     │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         data.frame        │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │        r_regionkey        │                                                          
                                                                                       │           r_name          │                                                          
                                                                                       └───────────────────────────┘                                                                                       
NULL
[38;5;246m# A tibble: 5 × 2[39m
  n_name      revenue
  [3m[38;5;246m<chr>[39m[23m         [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m JAPAN     45[4m4[24m[4m1[24m[4m0[24m176.
[38;5;250m2[39m INDIA     52[4m0[24m[4m3[24m[4m5[24m512.
[38;5;250m3[39m CHINA     53[4m7[24m[4m2[24m[4m4[24m494.
[38;5;250m4[39m VIETNAM   55[4m2[24m[4m9[24m[4m5[24m087.
[38;5;250m5[39m INDONESIA 55[4m5[24m[4m0[24m[4m2[24m041.
function () 
{
    summarise(select(filter(select(lineitem, l_shipdate, l_extendedprice, 
        l_discount, l_quantity), l_shipdate >= "1994-01-01", 
        l_shipdate < "1995-01-01", l_discount >= 0.05, l_discount <= 
            0.07, l_quantity < 24), l_extendedprice, l_discount), 
        revenue = sum(l_extendedprice * l_discount))
}
┌───────────────────────────┐
│      SIMPLE_AGGREGATE     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          sum(#0)          │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     *(l_extendedprice,    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #1            │
│             #2            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│l_shipdate BETWEEN '1994-01│
│-01'::DATE AND '1995-01-01'│
│ ::DATE AND CAST(l_quantity│
│ AS DOUBLE) < 24.000000 AND│
│ l_discount BETWEEN 0....  │
│        AND 0.070000       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         data.frame        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│         l_shipdate        │
└───────────────────────────┘                             
NULL
[38;5;246m# A tibble: 1 × 1[39m
     revenue
       [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m 123[4m1[24m[4m4[24m[4m1[24m078.
function () 
{
    sn <- select(inner_join(select(supplier, s_nationkey, s_suppkey), 
        filter(select(nation, n1_nationkey = n_nationkey, n1_name = n_name), 
            n1_name == "FRANCE" || n1_name == "GERMANY"), by = c(s_nationkey = "n1_nationkey")), 
        s_suppkey, n1_name)
    cn <- select(inner_join(select(customer, c_custkey, c_nationkey), 
        filter(select(nation, n2_nationkey = n_nationkey, n2_name = n_name), 
            n2_name == "FRANCE" || n2_name == "GERMANY"), by = c(c_nationkey = "n2_nationkey")), 
        c_custkey, n2_name)
    cno <- select(inner_join(select(orders, o_custkey, o_orderkey), 
        cn, by = c(o_custkey = "c_custkey")), o_orderkey, n2_name)
    cnol <- select(inner_join(filter(select(lineitem, l_orderkey, 
        l_suppkey, l_shipdate, l_extendedprice, l_discount), 
        l_shipdate >= "1995-01-01", l_shipdate <= "1996-12-31"), 
        cno, by = c(l_orderkey = "o_orderkey")), l_suppkey, l_shipdate, 
        l_extendedprice, l_discount, n2_name)
    all <- inner_join(cnol, sn, by = c(l_suppkey = "s_suppkey"))
    aggr <- arrange(summarise(group_by(select(mutate(filter(all, 
        (n1_name == "FRANCE" & n2_name == "GERMANY") | (n1_name == 
            "GERMANY" & n2_name == "FRANCE")), supp_nation = n1_name, 
        cust_nation = n2_name, l_year = as.integer(strftime(l_shipdate, 
            "%Y")), volume = l_extendedprice * (1 - l_discount)), 
        supp_nation, cust_nation, l_year, volume), supp_nation, 
        cust_nation, l_year), revenue = sum(volume)), supp_nation, 
        cust_nation, l_year)
    aggr
}
┌───────────────────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│  relation.supp_nation ASC │                                                                                                                                                 
│  relation.cust_nation ASC │                                                                                                                                                 
│    relation.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #5            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│    n1_name = FRANCE AND   │                                                                                                                                                 
│ n2_name = GERMANY OR ...  │                                                                                                                                                 
│ GERMANY AND n2_name =...  │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│    l_suppkey=s_suppkey    │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                       │         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_suppkey         │                                                                                       │         s_suppkey         │                             
│         l_shipdate        │                                                                                       │          n1_name          │                             
│      l_extendedprice      │                                                                                       │                           │                             
│         l_discount        │                                                                                       │                           │                             
│          n2_name          │                                                                                       │                           │                             
└─────────────┬─────────────┘                                                                                       └─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           ├──────────────┐                                                                        │           INNER           ├──────────────┐              
│   l_orderkey=o_orderkey   │              │                                                                        │  s_nationkey=n1_nationkey │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         PROJECTION        ││         PROJECTION        │                                                          │         PROJECTION        ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_orderkey        ││         o_orderkey        │                                                          │        s_nationkey        ││n_name = FRANCE OR n_name =│
│         l_suppkey         ││          n2_name          │                                                          │         s_suppkey         ││           GERMANY         │
│         l_shipdate        ││                           │                                                          │                           ││                           │
│      l_extendedprice      ││                           │                                                          │                           ││                           │
│         l_discount        ││                           │                                                          │                           ││                           │
└─────────────┬─────────────┘└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         HASH_JOIN         │                                                          │      R_DATAFRAME_SCAN     ││      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│l_shipdate BETWEEN '1995-01││           INNER           │                                                          │         data.frame        ││         data.frame        │
│-01'::DATE AND '1996-12-31'││    o_custkey=c_custkey    ├──────────────┐                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           ::DATE          ││                           │              │                                           │         s_suppkey         ││        n_nationkey        │
│                           ││                           │              │                                           │        s_nationkey        ││           n_name          │
└─────────────┬─────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│      R_DATAFRAME_SCAN     ││         PROJECTION        ││         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         data.frame        ││         o_custkey         ││         c_custkey         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         o_orderkey        ││          n2_name          │                                                                                       
│         l_orderkey        ││                           ││                           │                                                                                       
│         l_suppkey         ││                           ││                           │                                                                                       
│      l_extendedprice      ││                           ││                           │                                                                                       
│         l_discount        ││                           ││                           │                                                                                       
│         l_shipdate        ││                           ││                           │                                                                                       
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                    
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │      R_DATAFRAME_SCAN     ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         data.frame        ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  c_nationkey=n2_nationkey ├──────────────┐                                                                        
                             │         o_orderkey        ││                           │              │                                                                        
                             │         o_custkey         ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │      R_DATAFRAME_SCAN     ││           FILTER          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         data.frame        ││n_name = FRANCE OR n_name =│                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││           GERMANY         │                                                          
                                                          │         c_custkey         ││                           │                                                          
                                                          │        c_nationkey        ││                           │                                                          
                                                          └───────────────────────────┘└─────────────┬─────────────┘                                                                                       
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │      R_DATAFRAME_SCAN     │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         data.frame        │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │        n_nationkey        │                                                          
                                                                                       │           n_name          │                                                          
                                                                                       └───────────────────────────┘                                                                                       
NULL
[38;5;246m# A tibble: 4 × 4[39m
  supp_nation cust_nation l_year   revenue
  [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<chr>[39m[23m        [3m[38;5;246m<int>[39m[23m     [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m FRANCE      GERMANY       [4m1[24m995 54[4m6[24m[4m3[24m[4m9[24m733.
[38;5;250m2[39m FRANCE      GERMANY       [4m1[24m996 54[4m6[24m[4m3[24m[4m3[24m083.
[38;5;250m3[39m GERMANY     FRANCE        [4m1[24m995 52[4m5[24m[4m3[24m[4m1[24m747.
[38;5;250m4[39m GERMANY     FRANCE        [4m1[24m996 52[4m5[24m[4m2[24m[4m0[24m549.
function () 
{
    nr <- select(inner_join(select(nation, n1_nationkey = n_nationkey, 
        n1_regionkey = n_regionkey), select(filter(select(region, 
        r_regionkey, r_name), r_name == "AMERICA"), r_regionkey), 
        by = c(n1_regionkey = "r_regionkey")), n1_nationkey)
    cnr <- select(inner_join(select(customer, c_custkey, c_nationkey), 
        nr, by = c(c_nationkey = "n1_nationkey")), c_custkey)
    ocnr <- select(inner_join(filter(select(orders, o_orderkey, 
        o_custkey, o_orderdate), o_orderdate >= "1995-01-01", 
        o_orderdate <= "1996-12-31"), cnr, by = c(o_custkey = "c_custkey")), 
        o_orderkey, o_orderdate)
    locnr <- select(inner_join(select(lineitem, l_orderkey, l_partkey, 
        l_suppkey, l_extendedprice, l_discount), ocnr, by = c(l_orderkey = "o_orderkey")), 
        l_partkey, l_suppkey, l_extendedprice, l_discount, o_orderdate)
    locnrp <- select(inner_join(locnr, select(filter(select(part, 
        p_partkey, p_type), p_type == "ECONOMY ANODIZED STEEL"), 
        p_partkey), by = c(l_partkey = "p_partkey")), l_suppkey, 
        l_extendedprice, l_discount, o_orderdate)
    locnrps <- select(inner_join(locnrp, select(supplier, s_suppkey, 
        s_nationkey), by = c(l_suppkey = "s_suppkey")), l_extendedprice, 
        l_discount, o_orderdate, s_nationkey)
    all <- select(inner_join(locnrps, select(nation, n2_nationkey = n_nationkey, 
        n2_name = n_name), by = c(s_nationkey = "n2_nationkey")), 
        l_extendedprice, l_discount, o_orderdate, n2_name)
    aggr <- arrange(summarise(group_by(select(mutate(all, o_year = as.integer(strftime(o_orderdate, 
        "%Y")), volume = l_extendedprice * (1 - l_discount), 
        nation = n2_name), o_year, volume, nation), o_year), 
        mkt_share = sum(ifelse(nation == "BRAZIL", volume, 0))/sum(volume)), 
        o_year)
    aggr
}
┌───────────────────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│    relation.o_year ASC    │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│       HASH_GROUP_BY       │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│CASE  WHEN (nation = BRAZIL│                                                                                                                                                                                                           
│   ) THEN (volume) ELSE 0  │                                                                                                                                                                                                           
│        .000000 END        │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│      l_extendedprice      │                                                                                                                                                                                                           
│         l_discount        │                                                                                                                                                                                                           
│        o_orderdate        │                                                                                                                                                                                                           
│          n2_name          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│  s_nationkey=n2_nationkey │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         PROJECTION        │                                                                                                                                                                              │      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      │                                                                                                                                                                              │         data.frame        │
│         l_discount        │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        o_orderdate        │                                                                                                                                                                              │        n_nationkey        │
│        s_nationkey        │                                                                                                                                                                              │           n_name          │
└─────────────┬─────────────┘                                                                                                                                                                              └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│    l_suppkey=s_suppkey    │                                                                                                                                                               │                                           
└─────────────┬─────────────┘                                                                                                                                                               │                                                                        
┌─────────────┴─────────────┐                                                                                                                                                 ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                                                 │      R_DATAFRAME_SCAN     │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_suppkey         │                                                                                                                                                 │         data.frame        │                             
│      l_extendedprice      │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_discount        │                                                                                                                                                 │         s_suppkey         │                             
│        o_orderdate        │                                                                                                                                                 │        s_nationkey        │                             
└─────────────┬─────────────┘                                                                                                                                                 └───────────────────────────┘                                                          
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│    l_partkey=p_partkey    │                                                                                                                                  │                                                                        
└─────────────┬─────────────┘                                                                                                                                  │                                                                                                     
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                                                                                    │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_partkey         │                                                                                                                    │             #0            │                                                          
│         l_suppkey         │                                                                                                                    │                           │                                                          
│      l_extendedprice      │                                                                                                                    │                           │                                                          
│         l_discount        │                                                                                                                    │                           │                                                          
│        o_orderdate        │                                                                                                                    │                           │                                                          
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                                                                                    │           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           ├──────────────┐                                                                                                     │ p_type = ECONOMY ANODIZED │                                                          
│   l_orderkey=o_orderkey   │              │                                                                                                     │            STEEL          │                                                          
└─────────────┬─────────────┘              │                                                                                                     └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      R_DATAFRAME_SCAN     ││         PROJECTION        │                                                                                       │      R_DATAFRAME_SCAN     │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         data.frame        ││         o_orderkey        │                                                                                       │         data.frame        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        o_orderdate        │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        ││                           │                                                                                       │         p_partkey         │                                                          
│         l_partkey         ││                           │                                                                                       │           p_type          │                                                          
│         l_suppkey         ││                           │                                                                                       │                           │                                                          
│      l_extendedprice      ││                           │                                                                                       │                           │                                                          
│         l_discount        ││                           │                                                                                       │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘                                                                                       └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐                                                                                                                                                                              
                             │         HASH_JOIN         │                                                                                                                                                                              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
                             │           INNER           ├──────────────┐                                                                                                                                                               
                             │    o_custkey=c_custkey    │              │                                                                                                                                                               
                             └─────────────┬─────────────┘              │                                                                                                                                                                                            
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                 
                             │           FILTER          ││         PROJECTION        │                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
                             │ o_orderdate BETWEEN '1995 ││         c_custkey         │                                                                                                                                                 
                             │-01-01'::DATE AND '199...  ││                           │                                                                                                                                                 
                             │          '::DATE          ││                           │                                                                                                                                                 
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                                              
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                 
                             │      R_DATAFRAME_SCAN     ││         HASH_JOIN         │                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
                             │         data.frame        ││           INNER           │                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  c_nationkey=n1_nationkey ├──────────────┐                                                                                                                                  
                             │         o_orderkey        ││                           │              │                                                                                                                                  
                             │         o_custkey         ││                           │              │                                                                                                                                  
                             │        o_orderdate        ││                           │              │                                                                                                                                  
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                                               
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │      R_DATAFRAME_SCAN     ││         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         data.frame        ││        n1_nationkey       │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                                                    
                                                          │         c_custkey         ││                           │                                                                                                                    
                                                          │        c_nationkey        ││                           │                                                                                                                    
                                                          └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                                                                                       ┌─────────────┴─────────────┐                                                                                                                    
                                                                                       │         HASH_JOIN         │                                                                                                                    
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                                                       │           INNER           ├──────────────┐                                                                                                     
                                                                                       │  n1_regionkey=r_regionkey │              │                                                                                                     
                                                                                       └─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │      R_DATAFRAME_SCAN     ││         PROJECTION        │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         data.frame        ││             #0            │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                                                       │        n_nationkey        ││                           │                                                                                       
                                                                                       │        n_regionkey        ││                           │                                                                                       
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                                                                                    ┌─────────────┴─────────────┐                                                                                       
                                                                                                                    │           FILTER          │                                                                                       
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                                                    │      r_name = AMERICA     │                                                                                       
                                                                                                                    └─────────────┬─────────────┘                                                                                                                    
                                                                                                                    ┌─────────────┴─────────────┐                                                                                       
                                                                                                                    │      R_DATAFRAME_SCAN     │                                                                                       
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                                                    │         data.frame        │                                                                                       
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                                                    │        r_regionkey        │                                                                                       
                                                                                                                    │           r_name          │                                                                                       
                                                                                                                    └───────────────────────────┘                                                                                                                    
NULL
[38;5;246m# A tibble: 2 × 2[39m
  o_year mkt_share
   [3m[38;5;246m<int>[39m[23m     [3m[38;5;246m<dbl>[39m[23m
[38;5;250m1[39m   [4m1[24m995    0.034[4m4[24m
[38;5;250m2[39m   [4m1[24m996    0.041[4m5[24m
function () 
{
    p <- select(filter(select(part, p_name, p_partkey), grepl(".*green.*", 
        p_name)), p_partkey)
    psp <- inner_join(select(partsupp, ps_suppkey, ps_partkey, 
        ps_supplycost), p, by = c(ps_partkey = "p_partkey"))
    sn <- select(inner_join(select(supplier, s_suppkey, s_nationkey), 
        select(nation, n_nationkey, n_name), by = c(s_nationkey = "n_nationkey")), 
        s_suppkey, n_name)
    pspsn <- inner_join(psp, sn, by = c(ps_suppkey = "s_suppkey"))
    lpspsn <- select(inner_join(select(lineitem, l_suppkey, l_partkey, 
        l_orderkey, l_extendedprice, l_discount, l_quantity), 
        pspsn, by = c(l_suppkey = "ps_suppkey", l_partkey = "ps_partkey")), 
        l_orderkey, l_extendedprice, l_discount, l_quantity, 
        ps_supplycost, n_name)
    all <- select(inner_join(select(orders, o_orderkey, o_orderdate), 
        lpspsn, by = c(o_orderkey = "l_orderkey")), l_extendedprice, 
        l_discount, l_quantity, ps_supplycost, n_name, o_orderdate)
    aggr <- arrange(summarise(group_by(select(mutate(all, nation = n_name, 
        o_year = as.integer(strftime(o_orderdate, "%Y")), amount = l_extendedprice * 
            (1 - l_discount) - ps_supplycost * l_quantity), nation, 
        o_year, amount), nation, o_year), sum_profit = sum(amount)), 
        nation, o_year)
    aggr
}
┌───────────────────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│    relation.nation ASC    │                                                                                                                                                 
│    relation.o_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│      l_extendedprice      │                                                                                                                                                 
│         l_discount        │                                                                                                                                                 
│         l_quantity        │                                                                                                                                                 
│       ps_supplycost       │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│        o_orderdate        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        o_orderdate        │                                                                                                                                                 
│      l_extendedprice      │                                                                                                                                                 
│         l_discount        │                                                                                                                                                 
│         l_quantity        │                                                                                                                                                 
│       ps_supplycost       │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_orderkey=o_orderkey   │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         PROJECTION        │                                                                                                                    │      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_orderkey        │                                                                                                                    │         data.frame        │
│      l_extendedprice      │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │                                                                                                                    │         o_orderkey        │
│         l_quantity        │                                                                                                                    │        o_orderdate        │
│       ps_supplycost       │                                                                                                                    │                           │
│           n_name          │                                                                                                                    │                           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           ├──────────────┐                                                                                                                                  
│    l_suppkey=ps_suppkey   │              │                                                                                                                                  
│    l_partkey=ps_partkey   │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││           INNER           │                                                                                                                    
│         l_partkey         ││    ps_suppkey=s_suppkey   │                                                                                                                    
│         l_orderkey        ││                           ├───────────────────────────────────────────┐                                                                        
│      l_extendedprice      ││                           │                                           │                                                                        
│         l_discount        ││                           │                                           │                                                                        
│         l_quantity        ││                           │                                           │                                                                        
└─────────────┬─────────────┘└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│      R_DATAFRAME_SCAN     ││         PROJECTION        │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         data.frame        ││         ps_suppkey        │                             │         s_suppkey         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         ps_partkey        │                             │           n_name          │                                                          
│         l_orderkey        ││       ps_supplycost       │                             │                           │                                                          
│         l_partkey         ││                           │                             │                           │                                                          
│         l_suppkey         ││                           │                             │                           │                                                          
│         l_quantity        ││                           │                             │                           │                                                          
│      l_extendedprice      ││                           │                             │                           │                                                          
│         l_discount        ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           ├──────────────┐              │           INNER           ├──────────────┐                                           
                             │    ps_partkey=p_partkey   │              │              │  s_nationkey=n_nationkey  │              │                                           
                             └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         PROJECTION        ││         PROJECTION        ││      R_DATAFRAME_SCAN     ││      R_DATAFRAME_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         ps_suppkey        ││             #0            ││         data.frame        ││         data.frame        │                             
                             │         ps_partkey        ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │       ps_supplycost       ││                           ││         s_suppkey         ││        n_nationkey        │                             
                             │                           ││                           ││        s_nationkey        ││           n_name          │                             
                             └─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │      R_DATAFRAME_SCAN     ││           FILTER          │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         data.frame        ││  contains(CAST(p_name AS  │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     VARCHAR), 'green')    │                                                                                       
                             │         ps_partkey        ││                           │                                                                                       
                             │         ps_suppkey        ││                           │                                                                                       
                             │       ps_supplycost       ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │      R_DATAFRAME_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         data.frame        │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         p_partkey         │                                                                                       
                                                          │           p_name          │                                                                                       
                                                          └───────────────────────────┘                                                                                                                    
NULL
[38;5;246m# A tibble: 175 × 3[39m
   nation  o_year sum_profit
   [3m[38;5;246m<chr>[39m[23m    [3m[38;5;246m<int>[39m[23m      [3m[38;5;246m<dbl>[39m[23m
[38;5;250m 1[39m ALGERIA   [4m1[24m992  45[4m6[24m[4m3[24m[4m6[24m849.
[38;5;250m 2[39m ALGERIA   [4m1[24m993  46[4m0[24m[4m4[24m[4m4[24m208.
[38;5;250m 3[39m ALGERIA   [4m1[24m994  48[4m6[24m[4m9[24m[4m4[24m008.
[38;5;250m 4[39m ALGERIA   [4m1[24m995  44[4m4[24m[4m0[24m[4m2[24m274.
[38;5;250m 5[39m ALGERIA   [4m1[24m996  48[4m2[24m[4m8[24m[4m5[24m483.
[38;5;250m 6[39m ALGERIA   [4m1[24m997  48[4m6[24m[4m1[24m[4m1[24m833.
[38;5;250m 7[39m ALGERIA   [4m1[24m998  27[4m1[24m[4m3[24m[4m6[24m900.
[38;5;250m 8[39m BRAZIL    [4m1[24m992  45[4m2[24m[4m8[24m[4m0[24m217.
[38;5;250m 9[39m BRAZIL    [4m1[24m993  45[4m7[24m[4m6[24m[4m6[24m604.
[38;5;250m10[39m BRAZIL    [4m1[24m994  44[4m8[24m[4m5[24m[4m4[24m219.
[38;5;246m# … with 165 more rows[39m
function () 
{
    l <- select(filter(select(lineitem, l_orderkey, l_returnflag, 
        l_extendedprice, l_discount), l_returnflag == "R"), l_orderkey, 
        l_extendedprice, l_discount)
    o <- select(filter(select(orders, o_orderkey, o_custkey, 
        o_orderdate), o_orderdate >= "1993-10-01", o_orderdate < 
        "1994-01-01"), o_orderkey, o_custkey)
    lo <- select(inner_join(l, o, by = c(l_orderkey = "o_orderkey")), 
        l_extendedprice, l_discount, o_custkey)
    lo_aggr <- summarise(group_by(mutate(lo, volume = l_extendedprice * 
        (1 - l_discount)), o_custkey), revenue = sum(volume))
    c <- select(customer, c_custkey, c_nationkey, c_name, c_acctbal, 
        c_phone, c_address, c_comment)
    loc <- inner_join(lo_aggr, c, by = c(o_custkey = "c_custkey"))
    locn <- inner_join(loc, select(nation, n_nationkey, n_name), 
        by = c(c_nationkey = "n_nationkey"))
    res <- head(arrange(select(locn, o_custkey, c_name, revenue, 
        c_acctbal, n_name, c_address, c_phone, c_comment), revenue), 
        20)
    res
}
┌───────────────────────────┐                                                                                       
│           TOP_N           │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           Top 20          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│    relation.revenue ASC   │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         o_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         o_custkey         │                                                                                       
│          revenue          │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│           n_name          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           ├────────────────────────────────────────────────────────────────────────┐              
│  c_nationkey=n_nationkey  │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │      R_DATAFRAME_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         data.frame        │
│    o_custkey=c_custkey    ├───────────────────────────────────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                           │              │        n_nationkey        │
│                           │                                           │              │           n_name          │
└─────────────┬─────────────┘                                           │              └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             │         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             │         c_custkey         │                             
│          sum(#1)          │                             │        c_nationkey        │                             
│                           │                             │           c_name          │                             
│                           │                             │         c_acctbal         │                             
│                           │                             │          c_phone          │                             
│                           │                             │         c_address         │                             
│                           │                             │         c_comment         │                             
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│         PROJECTION        │                             │      R_DATAFRAME_SCAN     │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             │         data.frame        │                             
│           volume          │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│                           │                             │         c_custkey         │                             
│                           │                             │           c_name          │                             
│                           │                             │         c_address         │                             
│                           │                             │        c_nationkey        │                             
│                           │                             │          c_phone          │                             
│                           │                             │         c_acctbal         │                             
│                           │                             │         c_comment         │                             
└─────────────┬─────────────┘                             └───────────────────────────┘                                                          
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         o_custkey         │                                                                                       
│           volume          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      l_extendedprice      │                                                                                       
│         l_discount        │                                                                                       
│         o_custkey         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           ├──────────────┐                                                                        
│   l_orderkey=o_orderkey   │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         PROJECTION        ││         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            ││             #0            │                                                          
│             #1            ││             #1            │                                                          
│             #2            ││                           │                                                          
└─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│           FILTER          ││           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_returnflag = R     ││ o_orderdate BETWEEN '1993 │                                                          
│                           ││-10-01'::DATE AND '199...  │                                                          
│                           ││          '::DATE          │                                                          
└─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│      R_DATAFRAME_SCAN     ││      R_DATAFRAME_SCAN     │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         data.frame        ││         data.frame        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        ││         o_orderkey        │                                                          
│      l_extendedprice      ││         o_custkey         │                                                          
│         l_discount        ││        o_orderdate        │                                                          
│        l_returnflag       ││                           │                                                          
└───────────────────────────┘└───────────────────────────┘                                                                                       
NULL
[38;5;246m# A tibble: 20 × 8[39m
   o_custkey c_name  revenue c_acctbal n_name  c_address   c_phone c_comment    
       [3m[38;5;246m<int>[39m[23m [3m[38;5;246m<chr>[39m[23m     [3m[38;5;246m<dbl>[39m[23m     [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m        
[38;5;250m 1[39m     [4m6[24m[4m4[24m663 Custom…    861.    [4m9[24m292.  ARGENT… TpDebaozkK… 11-610… [38;5;246m"[39mgular ideas…
[38;5;250m 2[39m     [4m8[24m[4m4[24m998 Custom…    904.    [4m8[24m815.  INDONE… TyQ5km9qL8… 19-686… [38;5;246m"[39mrefully exp…
[38;5;250m 3[39m     [4m2[24m[4m2[24m174 Custom…    918.    [4m8[24m652.  BRAZIL  jkwK2wiPf9… 12-119… [38;5;246m"[39m cajole reg…
[38;5;250m 4[39m      [4m8[24m876 Custom…    941.     396.  ETHIOP… kDPEdwW8Xx… 15-282… [38;5;246m"[39mde of the e…
[38;5;250m 5[39m     [4m6[24m[4m8[24m098 Custom…    967.    [4m9[24m005.  MOROCCO Oz9L,bHruY… 25-413… [38;5;246m"[39mcies sleep …
[38;5;250m 6[39m     [4m2[24m[4m2[24m225 Custom…    981.    [4m5[24m721.  ETHIOP… PfHcT,jJSc… 15-434… [38;5;246m"[39miously. fin…
[38;5;250m 7[39m    [4m1[24m[4m0[24m[4m8[24m712 Custom…    986.     837.  KENYA   kmSaUNm8dk… 24-248… [38;5;246m"[39mgainst the …
[38;5;250m 8[39m     [4m7[24m[4m2[24m314 Custom…   [4m1[24m008.    [4m2[24m296.  MOROCCO RZYv9HI4eF… 25-477… [38;5;246m"[39mly regular …
[38;5;250m 9[39m     [4m4[24m[4m3[24m058 Custom…   [4m1[24m015.     -[31m23[39m[31m.[39m[31m4[39m KENYA   yKxt6hqb8PC 24-734… [38;5;246m"[39mbold, even …
[38;5;250m10[39m    [4m1[24m[4m2[24m[4m6[24m217 Custom…   [4m1[24m035.    [4m2[24m861.  UNITED… bHX5Y2VQ4A… 34-685… [38;5;246m"[39mhinly expre…
[38;5;250m11[39m    [4m1[24m[4m0[24m[4m6[24m537 Custom…   [4m1[24m036.    [4m2[24m745.  CANADA  OpCBWFtGQpV 13-619… [38;5;246m"[39min pinto be…
[38;5;250m12[39m    [4m1[24m[4m4[24m[4m6[24m230 Custom…   [4m1[24m044.    [4m8[24m237.  EGYPT   ,X6hbOuWTU… 14-535… [38;5;246m"[39mafter the e…
[38;5;250m13[39m     [4m4[24m[4m0[24m978 Custom…   [4m1[24m056.    -[31m104[39m[31m.[39m  INDIA   gKmMcgLkaQ… 18-667… [38;5;246m"[39musly final …
[38;5;250m14[39m     [4m3[24m[4m3[24m880 Custom…   [4m1[24m056.    [4m9[24m278.  IRAQ    68MgIxX5le… 21-148… [38;5;246m"[39ms sleep car…
[38;5;250m15[39m      [4m1[24m375 Custom…   [4m1[24m062.    [4m2[24m011.  KENYA   GBgJ4UKrag… 24-620… [38;5;246m"[39mrequests! e…
[38;5;250m16[39m     [4m6[24m[4m6[24m497 Custom…   [4m1[24m072.    [4m8[24m682.  IRAQ    qIx3cTyt9N… 21-409… [38;5;246m"[39m; quickly r…
[38;5;250m17[39m    [4m1[24m[4m1[24m[4m8[24m070 Custom…   [4m1[24m076.    [4m4[24m494.  MOROCCO wdT1PzX gp… 25-463… [38;5;246m"[39mole careful…
[38;5;250m18[39m     [4m3[24m[4m9[24m247 Custom…   [4m1[24m076.    [4m7[24m710.  JORDAN  0J1r2hapw7… 23-202… [38;5;246m"[39mare furious…
[38;5;250m19[39m     [4m2[24m[4m0[24m614 Custom…   [4m1[24m078.    [4m6[24m767.  FRANCE  0ar8dXwvjv… 16-124… [38;5;246m"[39mss the regu…
[38;5;250m20[39m     [4m9[24m[4m0[24m542 Custom…   [4m1[24m086.    [4m8[24m715.  SAUDI … e PacvMjNI… 30-809… [38;5;246m"[39mlly across …
> 
